# Glyco FFPEmics 糖肽分析系统

## 系统概述

Glyco FFPEmics 是一个专为FFPE（福尔马林固定石蜡包埋）样本糖肽组学分析设计的综合平台。该系统集成了从数据上传到结果可视化的完整分析流程，支持糖组分析、糖肽定性分析和糖肽定量分析三大核心模块，为糖肽组学研究提供强大的分析工具。

## 系统特色

- **多维度分析**：支持糖组分析、糖肽定性分析和糖肽定量分析三大核心模块
- **丰富可视化**：提供热图、火山图、ROC曲线、韦恩图等多种可视化方式
- **功能富集**：集成GO和KEGG通路富集分析
- **机器学习**：支持PCA、LDA、SVM等机器学习方法
- **用户友好**：直观的Web界面，支持结果下载和批量导出

## 适用场景

- FFPE样本糖肽组学研究
- 癌症糖基化标志物发现
- 糖肽定量差异分析
- 糖基化通路功能研究

## 系统架构

### 核心模块

1. **数据上传与质控**
   - 支持多种格式数据文件上传
   - 数据质量检查和样本匹配验证
   - 缺失值分析和数据分布可视化

2. **糖组分析**
   - 摩尔质量分布分析
   - 显著性差异糖链识别
   - 火山图可视化

3. **糖肽定性分析**
   - 样本分布分析
   - 相关性分析
   - PCA降维分析
   - 糖基化位点分布
   - Sankey图分析
   - Unique统计

4. **糖肽定量分析**（核心模块）
   - 热图分析（6种不同显示方式）
   - 区域热图分析
   - 韦恩图分析
   - LDA图和GO分析
   - KEGG分析
   - ROC分析
   - 火山图分析

## 安装指南

### 系统要求

- **操作系统**：Windows 10/11、macOS 10.14+、Linux (Ubuntu 18.04+)
- **内存**：建议8GB以上
- **存储空间**：至少2GB可用空间
- **网络**：需要稳定的网络连接（用于富集分析）
- **浏览器**：Chrome、Firefox、Safari、Edge（支持HTML5）

### 安装步骤

1. **安装R环境**
   ```bash
   # 下载并安装R (https://cran.r-project.org/)
   # 推荐版本：R 4.2.0 或更高版本
   ```

2. **安装RStudio**（可选但推荐）
   ```bash
   # 下载并安装RStudio (https://posit.co/download/rstudio-desktop/)
   ```

3. **克隆或下载项目**
   ```bash
   git clone [项目地址]
   # 或直接下载ZIP文件并解压
   ```

4. **安装依赖包**
   ```r
   # 在R中运行
   source("install_dependencies.R")
   ```

5. **启动应用**
   ```r
   # 在R中运行
   source("appchange.R")
   ```

## 使用指南

### 快速开始

1. **数据准备**
   - 准备组间归一化数据文件（.csv）
   - 准备患者信息文件（.csv）
   - 准备糖链类型文件（.csv）

2. **启动系统**
   - 运行`appchange.R`
   - 在浏览器中打开显示的地址

3. **数据上传**
   - 在"数据上传"页面依次上传三个文件
   - 检查上传状态和样本匹配情况

4. **数据质控**
   - 在"数据预览与质控"页面检查数据质量
   - 查看样本匹配状态和数据分布

5. **选择分析模块**
   - 根据研究目的选择相应的分析模块
   - 运行分析并查看结果

### 详细使用流程

#### 糖组分析
1. 上传数据文件
2. 设置有效值比例阈值
3. 点击"运行糖组分析"
4. 查看摩尔质量分布、显著性差异等结果

#### 糖肽定性分析
1. 上传数据文件
2. 点击"运行糖肽分析"
3. 查看样本分布、相关性、PCA等分析结果

#### 糖肽定量分析
1. 在"糖肽定量分析"页面上传专用数据文件
2. 选择相应的分析子模块
3. 运行分析并查看结果

## 数据格式要求

### 必需文件

1. **组间归一化数据文件** (.csv)
   - 包含糖肽鉴定和定量信息
   - 必需字段：`sample_id`、`final_scale_intensity`
   - 编码：UTF-8

2. **患者信息文件** (.csv)
   - 包含样本与患者分组的对应关系
   - 必需字段：`Sample`、`patients_repeat`
   - 编码：UTF-8

3. **糖链类型文件** (.csv)
   - 包含糖链组成与糖链类型的对应关系
   - 必需字段：`glycan`、`glycan.type`
   - 编码：UTF-8

### 糖肽定量分析专用文件

1. **填补缺失值_zscore后.csv**
   - 经过预处理的表达矩阵
   - 行：基因/糖肽，列：样本

2. **sample_group_PCA.csv**
   - 样本分组信息
   - 包含样本ID和分组标签

## 分析模块详解

### 糖肽定量分析子模块

1. **热图分析**
   - CRLM vs CRC热图
   - CRLM vs LIHC热图
   - 合并筛选基因热图
   - zscore标准化热图
   - 支持聚类和不聚类显示

2. **区域热图分析**
   - 均值比散点图
   - 区域统计
   - 差异热图和z-score热图

3. **韦恩图分析**
   - 不同筛选方法的比较
   - 显著性差异基因重叠分析
   - 差异基因热图可视化

4. **LDA图和GO分析**
   - PCA、LDA、SVM分析
   - GO功能富集分析
   - 糖链类型分布分析

5. **KEGG分析**
   - KEGG通路富集分析
   - 多种可视化方式
   - 详细的富集统计

6. **ROC分析**
   - 联合基因ROC曲线
   - 单个基因ROC曲线
   - AUC值排序表

7. **火山图分析**
   - 差异表达基因可视化
   - 蛋白质表达分析
   - 聚类数据准备

## 结果解释

### 常见图表说明

- **热图**：红色表示高表达，蓝色表示低表达
- **火山图**：X轴为log2倍数变化，Y轴为-log10(p值)
- **ROC曲线**：曲线下面积(AUC)越大表示诊断性能越好
- **韦恩图**：显示不同基因集合之间的重叠关系
- **GO/KEGG富集图**：显示显著富集的生物学通路

## 常见问题

### Q1: 上传文件后显示"样本匹配失败"怎么办？
A: 检查各文件中的样本ID是否完全一致，包括大小写、空格等细节。

### Q2: GO/KEGG分析显示"无富集结果"是什么原因？
A: 可能的原因包括：1) 显著性差异基因数量太少；2) 网络连接问题；3) 基因ID转换失败。

### Q3: 分析过程很慢怎么办？
A: 大数据集分析需要时间，建议关闭其他程序，耐心等待。

### Q4: 如何选择合适的分析模块？
A: 根据研究目的选择：糖组分析适合糖链水平研究，糖肽定性分析适合鉴定分析，糖肽定量分析适合差异表达研究。

## 技术支持

### 系统信息
- **版本**：v2.0
- **开发语言**：R + Shiny
- **最后更新**：2024年

### 更新日志

**v2.0 (2024年最新版本)**
- 新增糖肽定量分析模块
- 集成8个专业分析子模块
- 增强数据可视化功能
- 优化用户界面和交互体验
- 修复已知问题，提升系统稳定性

### 使用建议
- 首次使用建议先阅读帮助文档
- 大数据集分析时建议分批处理
- 重要结果请及时下载保存
- 定期备份分析结果和数据文件

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交问题报告和功能建议。如需贡献代码，请遵循以下步骤：
1. Fork本项目
2. 创建功能分支
3. 提交更改
4. 发起Pull Request

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交Issue
- 发送邮件至项目维护者1903180396@qq.com

---

**注意**：本系统专为FFPE样本糖肽组学分析设计，使用前请确保数据格式符合要求。如有疑问，请参考帮助文档或联系技术支持。 # GlycoFFPEmics
